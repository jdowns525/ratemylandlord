<div class="container">
  <div class="card">
    <div class="card-header">
      <div><h1>My Reviews</h1></div>
    </div>
  </div>


<hr>

<div class="container">
  <div class="card">
    <div class="card-header">Reviews</div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr>
              
              <th>Landlord</th>
              <th>Date of Vacancy</th>
              <th>Date of Occupancy</th>
              <th>Caption</th>
              <th>Useful</th>
              <th>Stars</th>
              <th>User</th>
              <th>City</th>
              <th>Updated</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% @reviews.each do |a_review| %>
            <tr>
              
              <td><%= link_to a_review.landlord_id, landlord_path(a_review.landlord) %></td>
              <td><%= a_review.date_occupancy %></td>
              <td><%= a_review.date_vacancy %></td>
              <td><%= a_review.text %></td>
              <td><%= a_review.useful %></td>
              <td><%= a_review.stars %></td>
              <td><%= a_review.user_id %></td>
              <td><%= a_review.city %></td>
              <td><%= time_ago_in_words(a_review.updated_at) %> ago</td>
              <td><a href="/reviews/<%= a_review.id %>" class="btn btn-primary"> Details</a></td>
              <td><%= form_with(url: "/reviews/#{a_review.id}", method: "delete", html: { onsubmit: "return confirm('Are you sure you want to delete?')" }) do %>
                  <%= submit_tag("Delete", class: "btn btn-danger") %></td>
                  <%end%>
                  </tr>
            <% end %>
          </tbody>
        </table>
        <%= will_paginate @reviews %>
      </div>
    </div>
  </div>
</div>

<hr>

<% if @current_user != nil %>
<div class="container">
  <h3 class="my-4">Write a Review</h3>
  <div class="card">
    <div class="card-header">
      Review Information
    </div>
    <div class="card-body">
      <form action="/reviews" method="post">
        <div class="form-group row">
          <label for="date_vacancy_box" class="col-md-2 col-form-label">Date of Vacancy</label>
          <div class="col-md-4">
            <input type="date" class="form-control" id="date_vacancy_box" name="query_date_vacancy" value="<%= Time.now.strftime('%Y-%m-%d') %>">
          </div>
          <label for="date_occupancy_box" class="col-md-2 col-form-label">Date of Occupancy</label>
          <div class="col-md-4">
            <input type="date" class="form-control" id="date_occupancy_box" name="query_date_occupancy" value="<%= Time.now.strftime('%Y-%m-%d') %>">
          </div>
        </div>

        <div class="form-group">
          <label for="text_box">Text</label>
          <textarea class="form-control" id="text_box" name="query_text" rows="3"></textarea>
        </div>

        <div class="form-group row">
          <label for="city_box" class="col-md-2 col-form-label">City</label>
          <div class="col-md-2">
            <input type="text" class="form-control" id="city_box" name="query_city">
          </div>
          <input type="hidden" name="query_user_id" value="<%= @current_user.id %>">
          
          <label for="landlord_id_box" class="col-md-2 col-form-label">Landlord ID</label>
          <div class="col-md-2">
            <input type="text" class="form-control" id="landlord_id_box" name="query_landlord_id">
          </div>
        </div>

        <div class="form-group row">
          <label for="stars_box" class="col-md-2 col-form-label">Stars</label>
          <div class="col-md-2">
            <input type="text" class="form-control" id="stars_box" name="query_stars">
          </div>
          <label for="useful_box" class="col-md-2 col-form-label">Useful?</label>
          <div class="col-md-2">
            <select class="form-control" id="useful_box" name="query_useful">
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <button type="submit" class="btn btn-primary">Create Review</button>
        </div>
      </form>
    </div> <!-- Close card-body -->
  </div> <!-- Close card -->
</div> <!-- Close container -->
<%end%>
